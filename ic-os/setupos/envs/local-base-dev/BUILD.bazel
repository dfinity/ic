load("//ic-os:defs.bzl", "icos_build")
load("//ic-os/scripts/bare_metal_deployment:tools.bzl", "launch_bare_metal")
load("//ic-os/setupos:defs.bzl", "image_deps")

exports_files(["build_container_filesystem_config.txt"])

# The macro contains several targets.
# Check
#       //ic-os/setupos/BUILD.bazel for examples
#    or //ic-os/defs.bzl for the full list of targets.
icos_build(
    name = "local-base-dev",
    build_local_base_image = True,
    ic_version = "//bazel:rc_only_version.txt",
    image_deps_func = image_deps,
    tags = ["manual"],
    upgrades = False,
    upload_prefix = None,  # Do not upload locally built base images
    visibility = ["//visibility:public"],
    vuln_scan = False,
)

launch_bare_metal(
    name = "launch_bare_metal",
    image_zst_file = ":disk-img.tar.zst",
)
