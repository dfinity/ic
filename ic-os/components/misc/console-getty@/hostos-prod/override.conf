[Service]
ExecStart=
ExecStart=-/opt/ic/bin/infogetty -u limited-console /dev/%I

### Security hardening: prevent privilege escalation and PATH hijacking
# Note: NoNewPrivileges=yes is omitted because limited-console requires sudo for running guestos-recovery-upgrader
# Isolates the service from other services' /tmp directory
PrivateTmp=yes
# Makes system directories read-only
ProtectSystem=strict
# Prevents the console process from accessing the /root directory
ProtectHome=yes
# Prevents the unprivileged user from modifying system-wide kernel parameters via /proc/sys
ProtectKernelTunables=yes
# Prevents the user from manipulating resource controls (CPU, memory)
# which could be used to perform Denial of Service (DoS) attacks or side-channel attempts.
ProtectControlGroups=yes
