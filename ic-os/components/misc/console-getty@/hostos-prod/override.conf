[Service]
ExecStart=
ExecStart=-/opt/ic/bin/infogetty -u limited-console /dev/%I

### Security hardening: prevent privilege escalation and PATH hijacking
# NoNewPrivileges is disabled to allow sudo for recovery operations
# Security is still enforced via sudoers (only guestos-recovery-upgrader.sh can use sudo)
# NoNewPrivileges=yes
# Isolates the service from other services' /tmp directory
PrivateTmp=yes
# Makes system directories read-only
ProtectSystem=strict
# Prevents the console process from accessing the /root directory
ProtectHome=yes
# Prevents the unprivileged user from modifying system-wide kernel parameters via /proc/sys
ProtectKernelTunables=yes
# Prevents the user from manipulating resource controls (CPU, memory)
# which could be used to perform Denial of Service (DoS) attacks or side-channel attempts.
ProtectControlGroups=yes
