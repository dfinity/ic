syntax = "proto3";

package remote_attestation;

import "attestation.proto";

service RemoteAttestationService {
  // Gets an SEV attestation package from the node
  rpc Attest(AttestRequest) returns (AttestResponse) {};
}

message AttestRequest {
  // 32-byte long custom data that will be included in the attestation report.
  optional bytes custom_data = 1;
}

message AttestResponse {
  // The SEV attestation package provided by the node.
  // The attestation report's custom data field has the following format which the attester should verify.
  // - first 4 bytes: [1, 0, 0, 0]
  // - following 28 bytes: undefined - may be used in the future
  // - last 32 bytes: the custom data provided in the request
  optional attestation.SevAttestationPackage attestation_package = 1;
}
