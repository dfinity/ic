// This file is @generated by prost-build.
/// SEV attestation package that is shared by a node as evidence of its integrity.
///
/// IMPORTANT: All fields in this message (and nested messages) MUST remain optional.
/// This type is used in the registry Candid API, and adding or removing
/// non-optional fields causes Candid client/server compatibility issues.
#[derive(
    candid::CandidType, candid::Deserialize, serde::Serialize, Clone, PartialEq, ::prost::Message,
)]
pub struct SevAttestationPackage {
    /// Opaque bytes containing the SEV attestation report. Can be parsed using
    /// sev::firmware::guest::AttestationReport::from_bytes.
    #[prost(bytes = "vec", optional, tag = "1")]
    #[serde(deserialize_with = "ic_utils::deserialize::deserialize_option_blob")]
    pub attestation_report: ::core::option::Option<::prost::alloc::vec::Vec<u8>>,
    #[prost(message, optional, tag = "2")]
    pub certificate_chain: ::core::option::Option<SevCertificateChain>,
    /// Description of the the custom data included in the attestation report.
    /// The custom data in the attestation report is 64 bytes, derived from some
    /// data. This field can be used to provide information about how the data
    /// was derived which can be useful for debugging purposes in case the verifier
    /// expects different data in the report.
    #[prost(string, optional, tag = "3")]
    pub custom_data_debug_info: ::core::option::Option<::prost::alloc::string::String>,
}
/// Certificate chain for SEV attestation verification.
/// NOTE: All fields must remain optional (see SevAttestationPackage comment).
#[derive(
    candid::CandidType, candid::Deserialize, serde::Serialize, Clone, PartialEq, ::prost::Message,
)]
pub struct SevCertificateChain {
    /// AMD Root Key (ARK) certificate in PEM encoding
    #[prost(string, optional, tag = "1")]
    pub ark_pem: ::core::option::Option<::prost::alloc::string::String>,
    /// AMD SEV Signing Key (ASK) certificate in PEM encoding
    #[prost(string, optional, tag = "2")]
    pub ask_pem: ::core::option::Option<::prost::alloc::string::String>,
    /// Versioned Chip Endorsement Key (VCEK) certificate in PEM encoding
    #[prost(string, optional, tag = "3")]
    pub vcek_pem: ::core::option::Option<::prost::alloc::string::String>,
}
/// / Verification error when verifying an attestation package
#[derive(
    candid::CandidType, candid::Deserialize, serde::Serialize, Clone, PartialEq, ::prost::Message,
)]
pub struct VerificationError {
    /// Message describing the error
    /// The use of this field is to provide a human-readable description of the
    /// error which can be useful if the client cannot deserialize the error
    /// details (because it's running an older version).
    #[prost(string, tag = "1")]
    pub message: ::prost::alloc::string::String,
    /// Verification error information. New error types can be added in the future.
    ///
    /// Compatibility note: If one of the detail variants needs new fields in the
    /// future, a new message type compatible with VerificationErrorDescription can
    /// be added (i.e. the new message type fields should be a superset of the
    /// fields of VerificationErrorDescription) and then the type can be replaced
    /// with the new message type in the detail variant.
    #[prost(oneof = "verification_error::Detail", tags = "2, 3, 4, 5, 6, 7, 8")]
    pub detail: ::core::option::Option<verification_error::Detail>,
}
/// Nested message and enum types in `VerificationError`.
pub mod verification_error {
    /// Verification error information. New error types can be added in the future.
    ///
    /// Compatibility note: If one of the detail variants needs new fields in the
    /// future, a new message type compatible with VerificationErrorDescription can
    /// be added (i.e. the new message type fields should be a superset of the
    /// fields of VerificationErrorDescription) and then the type can be replaced
    /// with the new message type in the detail variant.
    #[derive(
        candid::CandidType, candid::Deserialize, serde::Serialize, Clone, PartialEq, ::prost::Oneof,
    )]
    pub enum Detail {
        /// Generic internal error
        #[prost(message, tag = "2")]
        Internal(super::VerificationErrorDescription),
        /// The attestation report contains invalid data
        #[prost(message, tag = "3")]
        InvalidAttestationReport(super::VerificationErrorDescription),
        /// The provided certificate chain is invalid
        #[prost(message, tag = "4")]
        InvalidCertificateChain(super::VerificationErrorDescription),
        /// The chip ID in the attestation report does not match the expected chip ID
        #[prost(message, tag = "5")]
        InvalidChipId(super::VerificationErrorDescription),
        /// The custom data in the attestation report does not match the expected custom data
        #[prost(message, tag = "6")]
        InvalidCustomData(super::VerificationErrorDescription),
        /// The measurement in the attestation report does not match the expected measurement
        #[prost(message, tag = "7")]
        InvalidMeasurement(super::VerificationErrorDescription),
        /// The signature in the attestation report is not by the VCEK
        #[prost(message, tag = "8")]
        InvalidSignature(super::VerificationErrorDescription),
    }
}
#[derive(
    candid::CandidType, candid::Deserialize, serde::Serialize, Clone, PartialEq, ::prost::Message,
)]
pub struct VerificationErrorDescription {
    #[prost(string, tag = "1")]
    pub message: ::prost::alloc::string::String,
}
