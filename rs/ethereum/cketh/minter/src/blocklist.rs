use hex_literal::hex;
use ic_ethereum_types::Address;

#[cfg(test)]
mod tests;

/// The list of addresses to which we do not allow retrievals.
/// This list has been downloaded from:
/// https://www.treasury.gov/ofac/downloads/prgrmlst.txt
/// The script used to construct this list is available:
/// /rs/ethereum/cketh/minter/scripts/ofaq_blocklist.py
/// NOTE: Keep it sorted!
const ETH_ADDRESS_BLOCKLIST: &[Address] = &[
    Address::new(hex!("01e2919679362dFBC9ee1644Ba9C6da6D6245BB1")),
    Address::new(hex!("03893a7c7463AE47D46bc7f091665f1893656003")),
    Address::new(hex!("04DBA1194ee10112fE6C3207C0687DEf0e78baCf")),
    Address::new(hex!("05E0b5B40B7b66098C2161A5EE11C5740A3A7C45")),
    Address::new(hex!("07687e702b410Fa43f4cB4Af7FA097918ffD2730")),
    Address::new(hex!("0836222F2B2B24A3F36f98668Ed8F0B38D1a872f")),
    Address::new(hex!("08b2eFdcdB8822EfE5ad0Eae55517cf5DC544251")),
    Address::new(hex!("09193888b3f38C82dEdfda55259A82C0E7De875E")),
    Address::new(hex!("098B716B8Aaf21512996dC57EB0615e2383E2f96")),
    Address::new(hex!("0E3A09dDA6B20aFbB34aC7cD4A6881493f3E7bf7")),
    Address::new(hex!("0Ee5067b06776A89CcC7dC8Ee369984AD7Db5e06")),
    Address::new(hex!("12D66f87A04A9E220743712cE6d9bB1B5616B8Fc")),
    Address::new(hex!("1356c899D8C9467C7f71C195612F8A395aBf2f0a")),
    Address::new(hex!("169AD27A470D064DEDE56a2D3ff727986b15D52B")),
    Address::new(hex!("178169B423a011fff22B9e3F3abeA13414dDD0F1")),
    Address::new(hex!("179f48C78f57A3A78f0608cC9197B8972921d1D2")),
    Address::new(hex!("19Aa5Fe80D33a56D56c78e82eA5E50E5d80b4Dff")),
    Address::new(hex!("1da5821544e25c636c1417Ba96Ade4Cf6D2f9B5A")),
    Address::new(hex!("1E34A77868E19A6647b1f2F47B51ed72dEDE95DD")),
    Address::new(hex!("22aaA7720ddd5388A3c0A3333430953C68f1849b")),
    Address::new(hex!("23173fE8b96A4Ad8d2E17fB83EA5dcccdCa1Ae52")),
    Address::new(hex!("23773E65ed146A459791799d01336DB287f25334")),
    Address::new(hex!("242654336ca2205714071898f67E254EB49ACdCe")),
    Address::new(hex!("2573BAc39EBe2901B4389CD468F2872cF7767FAF")),
    Address::new(hex!("26903a5a198D571422b2b4EA08b56a37cbD68c89")),
    Address::new(hex!("2717c5e28cf931547B621a5dddb772Ab6A35B701")),
    Address::new(hex!("2f389cE8bD8ff92De3402FFCe4691d17fC4f6535")),
    Address::new(hex!("2F50508a8a3D323B91336FA3eA6ae50E55f32185")),
    Address::new(hex!("2FC93484614a34f26F7970CBB94615bA109BB4bf")),
    Address::new(hex!("330bdFADE01eE9bF63C209Ee33102DD334618e0a")),
    Address::new(hex!("35fB6f6DB4fb05e6A4cE86f2C93691425626d4b1")),
    Address::new(hex!("3aac1cC67c2ec5Db4eA850957b967Ba153aD6279")),
    Address::new(hex!("3Cffd56B47B7b41c56258D9C7731ABaDc360E073")),
    Address::new(hex!("3e37627dEAA754090fBFbb8bd226c1CE66D255e9")),
    Address::new(hex!("3eFA30704D2b8BBAc821307230376556cF8CC39e")),
    Address::new(hex!("407CcEeaA7c95d2FE2250Bf9F2c105aA7AAFB512")),
    Address::new(hex!("4736dCf1b7A3d580672CcE6E7c65cd5cc9cFBa9D")),
    Address::new(hex!("47CE0C6eD5B0Ce3d3A51fdb1C52DC66a7c3c2936")),
    Address::new(hex!("48549A34AE37b12F6a30566245176994e17C6b4A")),
    Address::new(hex!("502371699497d08D5339c870851898D6D72521Dd")),
    Address::new(hex!("527653eA119F3E6a1F5BD18fbF4714081D7B31ce")),
    Address::new(hex!("538Ab61E8A9fc1b2f93b3dd9011d662d89bE6FE6")),
    Address::new(hex!("53b6936513e738f44FB50d2b9476730C0Ab3Bfc1")),
    Address::new(hex!("5512d943eD1f7c8a43F3435C85F7aB68b30121b0")),
    Address::new(hex!("57b2B8c82F065de8Ef5573f9730fC1449B403C9f")),
    Address::new(hex!("58E8dCC13BE9780fC42E8723D8EaD4CF46943dF2")),
    Address::new(hex!("5A14E72060c11313E38738009254a90968F58f51")),
    Address::new(hex!("5cab7692D4E94096462119ab7bF57319726Eed2A")),
    Address::new(hex!("5efda50f22d34F262c29268506C5Fa42cB56A1Ce")),
    Address::new(hex!("5f6c97C6AD7bdd0AE7E0Dd4ca33A4ED3fDabD4D7")),
    Address::new(hex!("610B717796ad172B316836AC95a2ffad065CeaB4")),
    Address::new(hex!("653477c392c16b0765603074f157314Cc4f40c32")),
    Address::new(hex!("67d40EE1A85bf4a4Bb7Ffae16De985e8427B6b45")),
    Address::new(hex!("6aCDFBA02D390b97Ac2b2d42A63E85293BCc160e")),
    Address::new(hex!("6Bf694a291DF3FeC1f7e69701E3ab6c592435Ae7")),
    Address::new(hex!("6F1cA141A28907F78Ebaa64fb83A9088b02A8352")),
    Address::new(hex!("722122dF12D4e14e13Ac3b6895a86e84145b6967")),
    Address::new(hex!("723B78e67497E85279CB204544566F4dC5d2acA0")),
    Address::new(hex!("72a5843cc08275C8171E582972Aa4fDa8C397B2A")),
    Address::new(hex!("743494b60097A2230018079c02fe21a7B687EAA5")),
    Address::new(hex!("746Aebc06D2aE31B71ac51429A19D54E797878E9")),
    Address::new(hex!("756C4628E57F7e7f8a459EC2752968360Cf4D1AA")),
    Address::new(hex!("76D85B4C0Fc497EeCc38902397aC608000A06607")),
    Address::new(hex!("776198CCF446DFa168347089d7338879273172cF")),
    Address::new(hex!("77777FeDdddFfC19Ff86DB637967013e6C6A116C")),
    Address::new(hex!("7Db418b5D567A4e0E8c59Ad71BE1FcE48f3E6107")),
    Address::new(hex!("8281Aa6795aDE17C8973e1aedcA380258Bc124F9")),
    Address::new(hex!("833481186f16Cece3f1Eeea1a694c42034c3a0dB")),
    Address::new(hex!("83E5bC4Ffa856BB84Bb88581f5Dd62A433A25e0D")),
    Address::new(hex!("84443CFd09A48AF6eF360C6976C5392aC5023a1F")),
    Address::new(hex!("88fd245fEdeC4A936e700f9173454D1931B4C307")),
    Address::new(hex!("910Cbd523D972eb0a6f4cAe4618aD62622b39DbF")),
    Address::new(hex!("94A1B5CdB22c43faab4AbEb5c74999895464Ddaf")),
    Address::new(hex!("94Be88213a387E992Dd87DE56950a9aef34b9448")),
    Address::new(hex!("94C92F096437ab9958fC0A37F09348f30389Ae79")),
    Address::new(hex!("9AD122c22B14202B4490eDAf288FDb3C7cb3ff5E")),
    Address::new(hex!("a0e1c89Ef1a489c9C7dE96311eD5Ce5D32c20E4B")),
    Address::new(hex!("A160cdAB225685dA1d56aa342Ad8841c3b53f291")),
    Address::new(hex!("a5C2254e4253490C54cef0a4347fddb8f75A4998")),
    Address::new(hex!("A60C772958a3eD56c1F15dD055bA37AC8e523a0D")),
    Address::new(hex!("aEaaC358560e11f52454D997AAFF2c5731B6f8a6")),
    Address::new(hex!("af4c0B70B2Ea9FB7487C7CbB37aDa259579fe040")),
    Address::new(hex!("af8d1839c3c67cf571aa74B5c12398d4901147B3")),
    Address::new(hex!("b04E030140b30C27bcdfaafFFA98C57d80eDa7B4")),
    Address::new(hex!("b1C8094B234DcE6e03f10a5b673c1d8C69739A00")),
    Address::new(hex!("B20c66C4DE72433F3cE747b58B86830c459CA911")),
    Address::new(hex!("b541fc07bC7619fD4062A54d96268525cBC6FfEF")),
    Address::new(hex!("BA214C1c1928a32Bffe790263E38B4Af9bFCD659")),
    Address::new(hex!("bB93e510BbCD0B7beb5A853875f9eC60275CF498")),
    Address::new(hex!("c2a3829F459B3Edd87791c74cD45402BA0a20Be3")),
    Address::new(hex!("Ca0840578f57fE71599D29375e16783424023357")),
    Address::new(hex!("CC84179FFD19A1627E79F8648d09e095252Bc418")),
    Address::new(hex!("CEe71753C9820f063b38FDbE4cFDAf1d3D928A80")),
    Address::new(hex!("D0975B32cEa532eaDDdFC9c60481976e39dB3472")),
    Address::new(hex!("D21be7248e0197Ee08E0c20D4a96DEBdaC3D20Af")),
    Address::new(hex!("d47438C816c9E7f2E2888E060936a499Af9582b3")),
    Address::new(hex!("D4B88Df4D29F5CedD6857912842cff3b20C8Cfa3")),
    Address::new(hex!("D5d6f8D9e784d0e26222ad3834500801a68D027D")),
    Address::new(hex!("D691F27f38B395864Ea86CfC7253969B409c362d")),
    Address::new(hex!("D692Fd2D0b2Fbd2e52CFa5B5b9424bC981C30696")),
    Address::new(hex!("D82ed8786D7c69DC7e052F7A542AB047971E73d2")),
    Address::new(hex!("d8D7DE3349ccaA0Fde6298fe6D7b7d0d34586193")),
    Address::new(hex!("d90e2f925DA726b50C4Ed8D0Fb90Ad053324F31b")),
    Address::new(hex!("d96f2B1c14Db8458374d9Aca76E26c3D18364307")),
    Address::new(hex!("DD4c48C0B24039969fC16D1cdF626eaB821d3384")),
    Address::new(hex!("df231d99Ff8b6c6CBF4E9B9a945CBAcEF9339178")),
    Address::new(hex!("DF3A408c53E5078af6e8fb2A85088D46Ee09A61b")),
    Address::new(hex!("e7aa314c77F4233C18C6CC84384A9247c0cf367B")),
    Address::new(hex!("eDC5d01286f99A066559F60a585406f3878a033e")),
    Address::new(hex!("f4B067dD14e95Bab89Be928c07Cb22E3c94E0DAA")),
    Address::new(hex!("F60dD140cFf0706bAE9Cd734Ac3ae76AD9eBC32A")),
    Address::new(hex!("F67721A2D8F736E75a49FdD7FAd2e31D8676542a")),
    Address::new(hex!("F7B31119c2682c88d88D455dBb9d5932c65Cf1bE")),
    Address::new(hex!("FD8610d20aA15b7B2E3Be39B396a1bC3516c7144")),
    Address::new(hex!("ffbaC21a641Dcfe4552920138D90F3638B3c9fba")),
];

pub fn is_blocked(from_address: &Address) -> bool {
    ETH_ADDRESS_BLOCKLIST.binary_search(from_address).is_ok()
}
