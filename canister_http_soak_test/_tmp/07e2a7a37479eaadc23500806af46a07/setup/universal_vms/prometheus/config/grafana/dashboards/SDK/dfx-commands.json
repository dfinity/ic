{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 227,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 100,
      "panels": [],
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Total number of dfx commands executed during the selected time period",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 3,
        "x": 0,
        "y": 0
      },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": true,
        "text": {
          "valueSize": 80
        },
        "textMode": "auto"
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT count() as total_commands FROM $table WHERE $timeFilter\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Total Commands",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Count of unique users (identified by batch IDs) executing dfx commands",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 3,
        "x": 3,
        "y": 0
      },
      "id": 7,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": true,
        "text": {
          "valueSize": 80
        },
        "textMode": "auto"
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT uniq(batch) as unique_users\n FROM $table WHERE $timeFilter\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Unique Users",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "decimals": 1,
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "yellow",
                "value": 70
              },
              {
                "color": "green",
                "value": 90
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 0
      },
      "id": 2,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "sizing": "auto",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT countIf(\n  exit_code = 0 AND\n  (replica_reject_code = 0 OR replica_reject_code IS NULL) AND\n  (replica_error_code = '' OR replica_error_code IS NULL)\n) * 100.0 / count() as success_rate\n FROM $table WHERE $timeFilter\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Command Success Rate",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Distribution of operating systems used with dfx",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 0
      },
      "id": 11,
      "options": {
        "displayLabels": [
          "name",
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": [
            "value",
            "percent"
          ]
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT platform, count() as count\nFROM $table\nWHERE $timeFilter\nGROUP BY platform\nORDER BY count DESC\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Platform Distribution",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Distribution of network types used with dfx commands",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 0
      },
      "id": 12,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "list",
          "placement": "right",
          "showLegend": true
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT network_type, count() as count\nFROM $table\nWHERE $timeFilter and network_type != ''\nGROUP BY network_type\nORDER BY count DESC\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Network Type Usage",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Types of identities used with dfx commands",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 8
      },
      "id": 13,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "list",
          "placement": "right",
          "showLegend": true
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT identity_type, count() as count\nFROM $table\nWHERE $timeFilter and identity_type != ''\nGROUP BY identity_type\nORDER BY count DESC\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Identity Type Distribution",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Overall average command execution time (excluding outliers > 5min)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 16
      },
      "id": 701,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT avg(execution_time_ms) as avg_time_ms\n FROM $table WHERE $timeFilter AND execution_time_ms < 300000  -- 5 minutes\n\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Avg Execution Time",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Total number of commands that failed (exit_code != 0)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 16
      },
      "id": 702,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT count() as total_errors FROM $table WHERE $timeFilter AND exit_code != 0\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Total Errors",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 24
      },
      "id": 200,
      "panels": [],
      "title": "Usage Trends",
      "type": "row"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Weekly aggregation of command counts, showing usage volume patterns over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "commands"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 16,
        "w": 12,
        "x": 0,
        "y": 24
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  toStartOfWeek(date) as t,\n  count() as value\nFROM $table\nWHERE $timeFilter\n  \nGROUP BY t\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Weekly Command Usage",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Total command usage over time, showing adoption and growth patterns.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "fillOpacity": 20,
            "lineWidth": 2
          },
          "unit": "commands"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 40
      },
      "id": 14,
      "options": {
        "alertThreshold": true,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  $timeSeries as t,\n  count() as value\nFROM $table\nWHERE $timeFilter\n  \nGROUP BY t // Changed from implicit 't' + optional groupBy\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Usage Growth Trend",
      "type": "graph"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Weekly command usage trends, showing changes in command popularity over time",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidth": 0.96999999999999997,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "log"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 56
      },
      "id": 10,
      "options": {
        "barRadius": 0,
        "barWidth": 0.96999999999999997,
        "groupWidth": 0.69999999999999996,
        "legend": {
          "calcs": [
            "last",
            "mean",
            "diff"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "sortBy": "Last",
          "sortDesc": true
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  toStartOfWeek(date) as week,\n  command,\n  count() as Count\nFROM $table\nWHERE $timeFilter\nGROUP BY week, command\nORDER BY week, Count DESC\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Weekly Invocations",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 5,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "commands"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 72
      },
      "id": 5,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  $timeSeries as t,\n  version,\ncount() as command_count\n\nFROM $table\nWHERE $timeFilter\n  \nGROUP BY t, version // Changed from implicit 't' + optional groupBy\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "DFX Version Adoption",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "users"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 72
      },
      "id": 4,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  $timeSeries as t,\n  identity_type,\nuniq(concat(batch, toString(sequence))) as active_users\n,\nnetwork_type\n\nFROM $table\nWHERE $timeFilter\n  \nGROUP BY t, identity_type, network_type // Changed from implicit 't' + optional groupBy\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Active Users",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Number of unique users (batches) using dfx each week",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 3,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "users"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 88
      },
      "id": 14,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  toStartOfWeek(date) as t,\n  uniq(batch) as unique_users\n\nFROM $table\nWHERE $timeFilter\n  \nGROUP BY t\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Unique Users per Week",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 96
      },
      "id": 300,
      "panels": [],
      "title": "Performance",
      "type": "row"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Average and 95th percentile execution times for dfx commands. Commands taking longer than 5 minutes are filtered out to avoid skewing the averages. See the Execution Time Outliers panel below for details on slow commands.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "avg_time_ms"
            },
            "properties": [
              {
                "id": "custom.axisPlacement",
                "value": "left"
              },
              {
                "id": "custom.axisLabel",
                "value": "Average Execution Time (ms)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p95_time_ms"
            },
            "properties": [
              {
                "id": "custom.axisPlacement",
                "value": "left"
              },
              {
                "id": "custom.axisLabel",
                "value": "95th Percentile Time (ms)"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 96
      },
      "id": 21,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  $timeSeries as t,\n  avg(execution_time_ms) as avg_time_ms,\nquantile(0.95)(execution_time_ms) as p95_time_ms\n\nFROM $table\nWHERE $timeFilter\n  AND execution_time_ms < 300000  -- 5 minutes\n\nGROUP BY t // Changed from implicit 't' + optional groupBy\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Command Execution Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Commands taking longer than 5 minutes to execute. These outliers (about 3.5% of commands) are filtered from other panels to avoid skewing the averages. The table shows command details including parameters and context to help investigate slow executions.",
      "fieldConfig": {
        "defaults": {
          "align": "auto",
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "inspect": false,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "execution_time_ms"
            },
            "properties": [
              {
                "id": "unit",
                "value": "ms"
              },
              {
                "id": "custom.width",
                "value": 150
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "date"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 180
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "param_patterns"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 300
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 104
      },
      "id": 25,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "show": true
        },
        "frameIndex": 1,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "execution_time_ms"
          }
        ],
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "WITH ranked_outliers AS (\n  SELECT\n    command,\n    execution_time_ms,\n    date,\n    parameters,\n    row_number() OVER (PARTITION BY command ORDER BY execution_time_ms DESC) as rn\n  FROM $table\n  WHERE $timeFilter\n    AND execution_time_ms >= 300000  -- 5 minutes\n\n)\nSELECT\n  command,\n  execution_time_ms,\n  date,\n  // Format parameters from the specific outlier row\n  arrayStringConcat(\n    arrayMap(x -> concat(x.name, '=', x.value), parameters),\n    '; '\n  ) as param_patterns\nFROM ranked_outliers\nWHERE rn = 1\nORDER BY execution_time_ms DESC\nLIMIT 20\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Execution Time Outliers",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 112
      },
      "id": 400,
      "panels": [],
      "title": "Reliability",
      "type": "row"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Command success rates and performance metrics over time. Excludes commands taking longer than 5 minutes to avoid skewing the averages. Success rate is the percentage of commands that complete with exit code 0 and no replica errors.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.59999999999999998,
            "drawStyle": "line",
            "fillOpacity": 15,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "success_rate"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "min",
                "value": 0
              },
              {
                "id": "max",
                "value": 100
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "/.*_ms$/"
            },
            "properties": [
              {
                "id": "unit",
                "value": "ms"
              },
              {
                "id": "decimals",
                "value": 0
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 112
      },
      "id": 31,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "time_series",
          "query": "SELECT\n  $timeSeries as t,\n  command,\ncountIf(\n  exit_code = 0 AND\n  (replica_reject_code = 0 OR replica_reject_code IS NULL) AND\n  (replica_error_code = '' OR replica_error_code IS NULL)\n) * 100.0 / count() as success_rate\n,\navg(execution_time_ms) as avg_time_ms,\nquantile(0.95)(execution_time_ms) as p95_time_ms\n\n\nFROM $table\nWHERE $timeFilter\n  AND execution_time_ms < 300000  -- 5 minutes\n\nGROUP BY t, command // Changed from implicit 't' + optional groupBy\nORDER BY t\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Command Health",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Detailed analysis of critical dfx operations. Shows success rates, execution times, and usage context for important commands. Focuses on deployment, canister management, and cycles operations.",
      "fieldConfig": {
        "defaults": {
          "align": "auto",
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "inspect": false,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "command"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 200
              },
              {
                "id": "custom.align",
                "value": "left"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "executions"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "custom.align",
                "value": "right"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "success_rate"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "yellow",
                      "value": 70
                    },
                    {
                      "color": "green",
                      "value": 90
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "/.*_ms$/"
            },
            "properties": [
              {
                "id": "unit",
                "value": "ms"
              },
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "custom.align",
                "value": "right"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "/.*_types$/"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 150
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 112
      },
      "id": 32,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "fields": [
            "executions"
          ],
          "reducer": [
            "sum"
          ],
          "show": true
        },
        "frameIndex": 1,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "showHeader": true,
        "sortBy": [],
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT\n  command,\n  count() as executions,\ncountIf(exit_code = 0) * 100.0 / count() as success_rate,\navg(execution_time_ms) as avg_time_ms,\nquantile(0.95)(execution_time_ms) as p95_time_ms\n,\n  groupUniqArray(identity_type) as identity_types,\ngroupUniqArray(network_type) as network_types,\narrayStringConcat(groupUniqArray(arrayMap(x -> x.type, project_canisters)), ', ') as canister_types\n\nFROM $table\nWHERE $timeFilter\n  AND command IN (\n  'deploy',\n  'canister call',\n  'canister create',\n  'canister install',\n  'cycles balance',\n  'cycles top-up'\n)\nAND execution_time_ms < 300000  -- 5 minutes\n\nGROUP BY command\nORDER BY executions DESC\nLIMIT 20\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Critical Operations",
      "type": "table"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Analysis of most frequent error patterns by command and exit code",
      "fieldConfig": {
        "defaults": {
          "align": "auto",
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "inspect": false,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "command"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 200
              },
              {
                "id": "custom.align",
                "value": "left"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "error_code"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "custom.align",
                "value": "right"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "count"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 80
              },
              {
                "id": "custom.align",
                "value": "right"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "/date$/"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 180
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 120
      },
      "id": 15,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "frameIndex": 1,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "count"
          }
        ],
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT\n  command,\n  exit_code as error_code,\n  count() as count,\n  min(date) as first_seen,\n  max(date) as last_seen\nFROM $table\nWHERE $timeFilter AND exit_code != 0\nGROUP BY command, error_code\nORDER BY count DESC\nLIMIT 20\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Failure Analysis",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 128
      },
      "id": 500,
      "panels": [],
      "title": "Details & Environment",
      "type": "row"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "description": "Distribution of dfx versions in use, showing adoption patterns of new releases",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidth": 0.96999999999999997,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 128
      },
      "id": 9,
      "options": {
        "barRadius": 0,
        "barWidth": 0.96999999999999997,
        "groupWidth": 0.69999999999999996,
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": false,
          "values": [
            "value",
            "percent"
          ]
        },
        "orientation": "horizontal",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "SELECT\n  if(version_rank <= 5,\n     substring(version, 1, 15) || if(length(version) > 15, '...', ''),\n     'Other Versions') AS version_display,\n  sum(count) AS count\nFROM (\n  SELECT\n    version,\n    count() AS count,\n    row_number() OVER (ORDER BY count() DESC) AS version_rank\n  FROM $table\n  WHERE $timeFilter\n  GROUP BY version\n) AS ranked_versions\nGROUP BY version_display\nORDER BY count DESC\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Version Distribution",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "vertamedia-clickhouse-datasource",
        "uid": "P5756B9A86EF7C581"
      },
      "fieldConfig": {
        "defaults": {
          "align": "auto",
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "inspect": false,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 128
      },
      "id": 3,
      "options": {
        "cellHeight": "sm",
        "columns": {
          "command": {
            "align": "left",
            "title": "Command",
            "width": 150
          },
          "common_parameters": {
            "align": "left",
            "title": "Common Parameters",
            "width": 200
          },
          "count": {
            "align": "right",
            "title": "Usage Count",
            "width": 100
          },
          "identity_context": {
            "align": "left",
            "title": "Identity Types",
            "width": 100
          },
          "network_context": {
            "align": "left",
            "title": "Networks",
            "width": 100
          },
          "usage_percentage": {
            "align": "right",
            "title": "Usage %",
            "unit": "percent",
            "width": 80
          }
        },
        "footer": {
          "fields": [
            "count"
          ],
          "reducer": [
            "sum"
          ],
          "show": true
        },
        "frameIndex": 1,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ],
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "database": "sdk",
          "dateTimeColDataType": "date",
          "dateTimeType": "DATETIME",
          "format": "table",
          "query": "WITH command_patterns AS (\n  SELECT\n    command,\n    count() as count,\n    count() * 100.0 / (SELECT count() FROM $table WHERE $timeFilter) as percentage,\n    -- Group common parameter patterns\n    arraySort(groupUniqArray(parameters)) as param_patterns,\n    -- Track feature usage context\n    groupUniqArray(network_type) as networks_used,\n    groupUniqArray(identity_type) as identity_types\n  FROM $table\n  WHERE $timeFilter\n  GROUP BY command\n  ORDER BY count DESC\n  LIMIT 10\n)\nSELECT\n  command,\n  count,\n  round(percentage, 2) as usage_percentage,\n  -- Format parameter patterns for readability\n  arrayStringConcat(param_patterns, '; ') as common_parameters,\n  -- Include usage context\n  arrayStringConcat(networks_used, ', ') as network_context,\n  arrayStringConcat(identity_types, ', ') as identity_context\nFROM command_patterns\n",
          "refId": "A",
          "table": "dfx_commands"
        }
      ],
      "title": "Most Used Commands",
      "type": "table"
    }
  ],
  "preload": false,
  "schemaVersion": 40,
  "tags": [
    "dfx",
    "commands",
    "usage"
  ],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-30d",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "UTC",
  "title": "DFX Command Usage Dashboard",
  "uid": "eeh1k7tlccwlcc",
  "version": 8,
  "weekStart": ""
}